#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import os
import datetime
import calendar

# ----------------------------------------------------------------------------
#   КАЛЕНДАР ФІКСОВАНИХ ДАТ З РАНГОМ
# ----------------------------------------------------------------------------
# Ключ: (місяць, день)
# Значення: "solemnity" (урочистість/свято), "obligatory" (обов’язковий спомин)

FIXED_DATES = {
    # СІЧЕНЬ
    (1, 1):    "solemnity",   # Пресвятої Богородиці Марії
    (1, 2):    "obligatory",  # Свв. Василія Великого і Григорія з Назіанзу
    (1, 3):    "optional",    # Пресвятого Імені Ісуса
    (1, 5):    "optional",    # Бл. Марцеліни Даровської
    (1, 7):    "optional",    # Св. Раймонда Пеньяфортського
    (1, 13):   "optional",    # Св. Іларіона
    (1, 17):   "obligatory",  # Св. Антонія, абата
    (1, 20):   "optional",    # Св. Фабіана; Св. Севастіана
    (1, 21):   "obligatory",  # Св. Агнеси
    (1, 22):   "optional",    # Св. Вікентія
    (1, 24):   "obligatory",  # Св. Франциска Сальського
    (1, 25):   "solemnity",   # Навернення св. ап. Павла
    (1, 26):   "obligatory",  # Свв. Тимотея і Тита
    (1, 27):   "optional",    # Св. Ангеліни Мерічі
    (1, 28):   "obligatory",  # Св. Томи Аквінського
    (1, 30):   "optional",    # Бл. Броніслава Маркевича
    (1, 31):   "obligatory",  # Св. Йоана Боско

    # ЛЮТИЙ
    (2, 2):    "solemnity",   # Стрітення Господнє
    (2, 3):    "optional",    # Св. Власія; Св. Оскара
    (2, 5):    "obligatory",  # Св. Агати
    (2, 6):    "obligatory",  # Свв. Павла Мікі
    (2, 8):    "optional",    # Св. Єроніма Еміліані; Св. Жозефіни Бакіти
    (2, 10):   "obligatory",  # Св. Схоластики
    (2, 11):   "optional",    # Пресвятої Діви Марії Лурдської
    (2, 14):   "solemnity",   # Свв. Кирила і Мефодія
    (2, 17):   "optional",    # Свв. семи засновників СДМ
    (2, 21):   "optional",    # Св. Петра Даміані
    (2, 22):   "solemnity",   # Престолу св. ап. Петра
    (2, 23):   "obligatory",  # Св. Полікарпа

    # БЕРЕЗЕНЬ
    (3, 4):    "optional",    # Св. Казимира
    (3, 7):    "obligatory",  # Свв. Перпетуї та Феліцити
    (3, 8):    "optional",    # Св. Йоана Божого
    (3, 9):    "optional",    # Св. Франциски римлянки
    (3, 17):   "optional",    # Св. Патрика
    (3, 18):   "optional",    # Св. Кирила Єрусалимського
    (3, 19):   "solemnity",   # Св. Йосифа, Обручника
    (3, 23):   "optional",    # Св. Турибія Монгровехського
    (3, 25):   "solemnity",   # Благовіщення Господнє

    # КВІТЕНЬ
    (4, 1):    "optional",    # Пресвятої Діви Марії Милостивої
    (4, 2):    "optional",    # Св. Франциска з Паулі
    (4, 4):    "optional",    # Св. Ізидора
    (4, 5):    "optional",    # Св. Вікентія Феррера
    (4, 7):    "obligatory",  # Св. Йоана Батіста де ля Саль
    (4, 13):   "optional",    # Св. Мартина І
    (4, 21):   "optional",    # Св. Анзельма
    (4, 23):   "optional",    # Св. Юрія; Св. Адальберта
    (4, 24):   "optional",    # Св. Фіделіса
    (4, 25):   "solemnity",   # Св. Марка
    (4, 28):   "optional",    # Св. Петра Шанеля; Св. Людовіка де Монфор

    # ТРАВЕНЬ
    (5, 1):    "optional",    # Св. Йосифа, Робітника
    (5, 2):    "obligatory",  # Св. Атанасія
    (5, 3):    "solemnity",   # Свв. Филипа та Якова
    (5, 8):    "obligatory",  # Св. Станіслава
    (5, 12):   "optional",    # Свв. Нерея і Ахілла; Св. Панкратія
    (5, 13):   "optional",    # Пресвятої Діви Марії Фатімської
    (5, 14):   "solemnity",   # Св. Матія
    (5, 16):   "optional",    # Св. Андрія Боболі
    (5, 18):   "optional",    # Св. Йоана І
    (5, 20):   "optional",    # Св. Бернардина Сієнського
    (5, 21):   "optional",    # Св. Христофора Магалланеса; Св. Йоана з Непомука
    (5, 22):   "optional",    # Св. Рити Кассійської
    (5, 25):   "optional",    # Св. Беди Достойного; Св. Григорія VII; Св. Марії Магдалини де Пацці
    (5, 26):   "obligatory",  # Св. Филипа Нері
    (5, 27):   "optional",    # Св. Августина Кентерберійського
    (5, 31):   "solemnity",   # Відвідини Пречистої Діви Марії

    # ЧЕРВЕНЬ
    (6, 1):    "obligatory",  # Св. Юстина
    (6, 2):    "optional",    # Свв. Марцеліна і Петра
    (6, 3):    "obligatory",  # Свв. Карла Лванги
    (6, 5):    "obligatory",  # Св. Боніфатія
    (6, 6):    "optional",    # Св. Норберта
    (6, 9):    "optional",    # Св. Єфрема
    (6, 11):   "obligatory",  # Св. Варнави
    (6, 13):   "obligatory",  # Св. Антонія Падуанського
    (6, 17):   "optional",    # Св. Альберта Хмельовського
    (6, 19):   "optional",    # Св. Ромуальда
    (6, 21):   "obligatory",  # Св. Алойзія Гонзаги
    (6, 22):   "optional",    # Св. Пауліна Ноланського; Свв. Йоана Фішера і Томи Мора
    (6, 24):   "solemnity",   # Народження св. Йоана Хрестителя
    (6, 26):   "optional",    # Св. Зигмунта Гораздовського
    (6, 27):   "optional",    # Св. Кирила Олександрійського
    (6, 28):   "obligatory",  # Св. Іринея
    (6, 29):   "solemnity",   # Свв. Петра і Павла
    (6, 30):   "optional",    # Першомученики Римської Церкви

    # ЛИПЕНЬ
    (7, 3):    "solemnity",   # Св. Томі, апостолу
    (7, 4):    "optional",    # Св. Єлизавети Португальської
    (7, 5):    "optional",    # Св. Антонія Марії Заккарії
    (7, 6):    "optional",    # Св. Марії Горетті
    (7, 8):    "optional",    # Св. Йоана з Дуклі
    (7, 9):    "optional",    # Св. Августина Зао Ронга
    (7, 11):   "solemnity",   # Св. Бенедикта
    (7, 13):   "optional",    # Св. Генріха
    (7, 14):   "optional",    # Св. Каміля де Леллі
    (7, 15):   "obligatory",  # Св. Бонавентури
    (7, 16):   "optional",    # Пресвятої Діви Марії з гори Кармель
    (7, 18):   "optional",    # Св. Ядвіги
    (7, 20):   "optional",    # Св. Аполлінарія
    (7, 21):   "optional",    # Св. Лаврентія Бріндізійського
    (7, 22):   "obligatory",  # Св. Марії Магдалини
    (7, 23):   "solemnity",   # Св. Бригіди
    (7, 24):   "optional",    # Св. Ольги; Св. Шарбеля Маклюфа
    (7, 25):   "solemnity",   # Св. Якова, апостола
    (7, 26):   "optional",    # Свв. Йоакима та Анни
    (7, 28):   "optional",    # Св. Володимира
    (7, 29):   "optional",    # Св. Марти; Св. Петро Хризолог
    (7, 31):   "obligatory",  # Св. Ігнатія Лойоли

    # СЕРПЕНЬ
    (8, 1):    "obligatory",  # Св. Альфонса Марії Лігуорі
    (8, 2):    "optional",    # Св. Євсевія Верчеллійського; Св. Петра Юліана Еймара
    (8, 4):    "obligatory",  # Св. Йоана Марії Віаннея
    (8, 5):    "solemnity",   # Річниця освячення Римської базиліки (зазвичай застосовують)
    (8, 6):    "solemnity",   # Преображення Господнє
    (8, 7):    "optional",    # Свв. Сікста ІІ; Св. Каетана
    (8, 8):    "obligatory",  # Св. Домініка
    (8, 9):    "solemnity",   # Св. Терези Авільської
    (8, 10):   "solemnity",   # Св. Лаврентія
    (8, 11):   "obligatory",  # Св. Клари
    (8, 12):   "optional",    # Св. Йоани Франциски де Шанталь
    (8, 13):   "optional",    # Свв. Понтіана та Іполита
    (8, 14):   "obligatory",  # Св. Максиміліана Кольбе
    (8, 15):   "solemnity",   # Успіння Пресвятої Діви Марії
    (8, 16):   "optional",    # Св. Стефана Угорського
    (8, 17):   "optional",    # Св. Гіацинта
    (8, 19):   "optional",    # Св. Йоана Оде
    (8, 20):   "obligatory",  # Св. Бернарда
    (8, 21):   "obligatory",  # Св. Пія X
    (8, 22):   "obligatory",  # Пресвятої Діви Марії Цариці
    (8, 23):   "optional",    # Св. Рози з Ліми
    (8, 24):   "solemnity",   # Св. Варфоломія, апостола
    (8, 25):   "optional",    # Св. Людовіка; Св. Йосифа Каласанті
    (8, 26):   "optional",    # Пресвятої Діви Марії Ченстоховської
    (8, 27):   "obligatory",  # Св. Моніки
    (8, 28):   "obligatory",  # Св. Августина
    (8, 29):   "obligatory",  # Мучеництва св. Йоана Хрестителя

    # ВЕРЕСЕНЬ
    (9, 3):    "obligatory",  # Св. Григорія Великого
    (9, 8):    "solemnity",   # Народження Пресвятої Діви Марії
    (9, 9):    "optional",    # Св. Петра Клавера; Бл. Владислава
    (9, 12):   "optional",    # Пресвятого Імені Марії
    (9, 13):   "obligatory",  # Св. Йоана Золотоустого
    (9, 14):   "solemnity",   # Воздвиження Всечесного Хреста
    (9, 15):   "obligatory",  # Пресвятої Діви Марії Страждальної
    (9, 16):   "obligatory",  # Свв. Корнелія і Кипріяна
    (9, 17):   "optional",    # Св. Роберта Белларміно
    (9, 18):   "obligatory",  # Св. Станіслава Костки
    (9, 19):   "optional",    # Св. Януарія
    (9, 20):   "obligatory",  # Свв. Андрія Кім Тегона
    (9, 21):   "solemnity",   # Св. Матея
    (9, 23):   "obligatory",  # Св. Піо з П’єтрельчіни
    (9, 26):   "optional",    # Свв. Косьми і Даміана
    (9, 27):   "optional",    # Св. Вікентія де Поль
    (9, 28):   "optional",    # Св. Вацлава; Свв. Лаврентія Руїз
    (9, 29):   "solemnity",   # Святих Архангелів Михаїла, Гавриїла, Рафаїла
    (9, 30):   "obligatory",  # Св. Єроніма

    # ЖОВТЕНЬ
    (10, 1):   "obligatory",  # Св. Терези від Дитяти Ісуса
    (10, 2):   "obligatory",  # Святих Ангелів-Хранителів
    (10, 4):   "obligatory",  # Св. Франциска Ассізького
    (10, 6):   "optional",    # Св. Бруно
    (10, 7):   "obligatory",  # Пресвятої Діви Марії Розарія
    (10, 9):   "optional",    # Св. Діонісія; Св. Йоана Леонарді
    (10, 14):  "solemnity",   # Св. Калікста І
    (10, 15):  "obligatory",  # Св. Терези від Ісуса (Авільська)
    (10, 16):  "optional",    # Св. Ядвіги; Св. Маргарити Марії Алакок
    (10, 17):  "obligatory",  # Св. Ігнатія Антіохійського
    (10, 18):  "solemnity",   # Св. Луки, євангеліста
    (10, 19):  "optional",    # Свв. Йоана де Бребе; Св. Павла від Хреста
    (10, 22):  "optional",    # Св. Йоана Капістрана
    (10, 23):  "optional",    # Св. Йосифа Більчевського
    (10, 24):  "optional",    # Св. Антонія Марії Кларе
    (10, 28):  "solemnity",   # Свв. Симона і Юди (Тадея)
}

# ----------------------------------------------------------------------------
#   ІНВИТАТОРІЙ: АНТИФОН І ПСАЛМИ
# ----------------------------------------------------------------------------

ANTIPHON = (
    "Підемо, радісно заспіваємо Господу, *<br>"
    "будемо вигукувати Скелі нашого спасіння."
)

INVIT_START = (
    "<p class=\"inv\">\n"
    "  В. Господи, відкрий уста мої.<br>\n"
    "  У. І вуста мої возвістять хвалу Твою.\n"
    "</p>\n"
)

# Псалми у форматі: [(рядок_тексту, чи_повторювати_антифон), ...]
PSALM_95 = [
    ("<p class=\"psalm\">Псалом 95 «Запрошення до прослави Бога»</p>", False),
    ("<p class=\"verse\">\n"
     "  Підемо, радісно заспіваємо Господу, *<br>\n"
     "  будемо вигукувати Скелі нашого спасіння.<br>\n"
     "  Прийдемо в Його присутність із хвалою – *<br>\n"
     "  і радісно співатимемо Йому пісні.\n"
     "</p>", True),
    ("<p class=\"verse\">\n"
     "  Адже Господь – величний Бог, *<br>\n"
     "  Він великий цар над усіма богами.<br>\n"
     "  В Його руці – земні простори, *<br>\n"
     "  Йому належать вершини гір.\n"
     "</p>", True),
    ("<p class=\"verse\">\n"
     "  І море – Його, – Він його створив, *<br>\n"
     "  і суходіл створили Його руки.\n"
     "</p>", True),
    ("<p class=\"verse\">\n"
     "  Підемо, поклонимося, припадемо, *<br>\n"
     "  і впадемо на коліна перед Господом,<br>\n"
     "  який нас створив.\n"
     "</p>", True),
    ("<p class=\"verse\">\n"
     "  Адже Він є наш Бог, †<br>\n"
     "  ми – Його народ, частина Його отари, *<br>\n"
     "  вівці під Його рукою.\n"
     "</p>", True),
    ("<p class=\"verse\">\n"
     "  Сьогодні, коли почуєте Його голос: †<br>\n"
     "  «Не робіть закам’янілими ваші серця,<br>\n"
     "  як біля Мериви, *<br>\n"
     "  в день випробування в пустелі,<br>\n"
     "  де спокушали Мене ваші батьки. *<br>\n"
     "  Вони випробували Мене, хоча побачили Мої діла.\n"
     "</p>", True),
    ("<p class=\"verse\">\n"
     "  Сорок років Мене засмучував цей рід, †<br>\n"
     "  тож Я сказав: Вони – народ, що блукає серцем! *<br>\n"
     "  Не пізнали вони Моїх доріг,<br>\n"
     "  тому Я поклявся у своєму гніві, *<br>\n"
     "  що вони не увійдуть до Мого відпочинку!\"\n"
     "</p>", True),
    ("<p class=\"verse\">\n"
     "  Слава Отцю, і Сину, *<br>\n"
     "  і Святому Духу.<br>\n"
     "  Яка була на початку, і нині, і повсякчас, *<br>\n"
     "  і на віки вічні. Амінь.\n"
     "</p>", True),
]

PSALM_100 = [
    ("<p class=\"psalm\">Псалом 100 «Радість тих, що входять до храму»</p>", False),
    ("<p class=\"verse\">\n"
     "  Вигукуй Господу, вся земле! *<br>\n"
     "  Служіть Господу з радістю,<br>\n"
     "  з’явіться веселими *<br>\n"
     "  перед Ним.\n"
     "</p>", True),
    ("<p class=\"verse\">\n"
     "  Знайте, що Господь є Бог, *<br>\n"
     "  що Він створив нас,<br>\n"
     "  і ми Йому належимо; *<br>\n"
     "  ми – Його народ, вівці Його отари.\n"
     "</p>", True),
    ("<p class=\"verse\">\n"
     "  Входьте в Його брами з подякою, *<br>\n"
     "  в Його двори – з хвалою.<br>\n"
     "  Славте Його, хваліть Його Ім’я, *<br>\n"
     "  бо Господь добрий,<br>\n"
     "  Його милосердя – навіки, *<br>\n"
     "  і Його вірність – із роду в рід.\n"
     "</p>", True),
    ("<p class=\"verse\">\n"
     "  Слава Отцю, і Сину, *<br>\n"
     "  і Святому Духу.<br>\n"
     "  Яка була на початку, і нині, і повсякчас, *<br>\n"
     "  і на віки вічні. Амінь.\n"
     "</p>", True),
]

PSALM_24 = [
    # Заголовок псалма (без повторення антифона)
    ("<p class=\"psalm\">Псалом 24 «Господь входить до храму»</p>", False),
    
    # Вірш 1
    ("<p class=\"verse\">\n"
     "  Земля і все, що наповняє її, *<br>\n"
     "  Всесвіт і ті, що живуть у ньому – вони Господні.\n"
     "</p>", True),
    
    # Вірш 2
    ("<p class=\"verse\">\n"
     "  Адже Він заснував її на морях, *<br>\n"
     "  і на ріках облаштував її.\n"
     "</p>", True),
    
    # Вірш 3
    ("<p class=\"verse\">\n"
     "  Хто вийде на гору Господню, *<br>\n"
     "  і хто стане на Його святому місці?\n"
     "</p>", True),
    
    # Вірш 4
    ("<p class=\"verse\">\n"
     "  Той, у кого руки невинні й серце чисте, †<br>\n"
     "  хто не прив’язав до марного свою душу *<br>\n"
     "  і підступно не клявся.\n"
     "</p>", True),
    
    # Вірш 5
    ("<p class=\"verse\">\n"
     "  Такий отримає благословення від Господа *<br>\n"
     "  і справедливу винагороду від Бога, свого Спасителя.\n"
     "</p>", True),
    
    # Вірш 6
    ("<p class=\"verse\">\n"
     "  Це покоління тих, які шукають Його, – *<br>\n"
     "  шукають обличчя Бога Якова.\n"
     "</p>", True),
    
    # Вірш 7
    ("<p class=\"verse\">\n"
     "  Підніміть, брами, свої голови, – †<br>\n"
     "  підніміться, вічні брами, *<br>\n"
     "  хай увійде Цар слави!\n"
     "</p>", True),
    
    # Вірш 8
    ("<p class=\"verse\">\n"
     "  Хто ж Той Цар слави? *<br>\n"
     "  Це Господь – могутній і сильний, *<br>\n"
     "  Господь, могутній у битві.\n"
     "</p>", True),
    
    # Вірш 9 (повтор заклику про ворота)
    ("<p class=\"verse\">\n"
     "  Підніміть, брами, свої голови, – †<br>\n"
     "  підніміться, вічні брами, *<br>\n"
     "  хай увійде Цар слави!\n"
     "</p>", True),
    
    # Вірш 10 (заключне питання й відповідь)
    ("<p class=\"verse\">\n"
     "  Хто ж Той Цар слави? *<br>\n"
     "  Господь сил – Він Цар слави.\n"
     "</p>", True),
    
    # Слава Отцю …
    ("<p class=\"verse\">\n"
     "  Слава Отцю, і Сину, *<br>\n"
     "  і Святому Духу.<br>\n"
     "  Яка була на початку, і нині, і повсякчас, *<br>\n"
     "  і на віки вічні. Амінь.\n"
     "</p>", True),
]


PSALM_67 = [
    # Заголовок псалма (без повторення антифона)
    ("<p class=\"psalm\">Псалом 67 «Нехай всі народи прославляють Бога»</p>", False),

    # Вірш 1
    ("<p class=\"verse\">\n"
     "  Боже, будь милосердний до нас *<br>\n"
     "  і поблагослови нас, *<br>\n"
     "  осяй нас своїм обличчям.\n"
     "</p>", True),

    # Вірш 2
    ("<p class=\"verse\">\n"
     "  Щоби ми пізнали Твою дорогу на землі; *<br>\n"
     "  Твоє спасіння – між усіма народами.\n"
     "</p>", True),

    # Вірш 3
    ("<p class=\"verse\">\n"
     "  Хай прославлять Тебе народи, Боже; *<br>\n"
     "  нехай прославлять Тебе всі племена.\n"
     "</p>", True),

    # Вірш 4
    ("<p class=\"verse\">\n"
     "  Хай веселяться і радіють народи, †<br>\n"
     "  бо Ти судиш народи праведно *<br>\n"
     "  і ведеш народи на землі.\n"
     "</p>", True),

    # Вірш 5
    ("<p class=\"verse\">\n"
     "  Хай прославлять Тебе народи, Боже; *<br>\n"
     "  нехай прославлять Тебе всі племена.\n"
     "</p>", True),

    # Вірш 6
    ("<p class=\"verse\">\n"
     "  Земля дала свій урожай. *<br>\n"
     "  Бог, наш Бог, благословляє нас.\n"
     "</p>", True),

    # Вірш 7
    ("<p class=\"verse\">\n"
     "  Нехай благословить нас Бог *<br>\n"
     "  і нехай бояться Його всі кінці землі.\n"
     "</p>", True),

    # Слава Отцю …
    ("<p class=\"verse\">\n"
     "  Слава Отцю, і Сину, *<br>\n"
     "  і Святому Духу.<br>\n"
     "  Яка була на початку, і нині, і повсякчас, *<br>\n"
     "  і на віки вічні. Амінь.\n"
     "</p>", True),
]


# ----------------------------------------------------------------------------
#  ФУНКЦІЯ: ВИЗНАЧИТИ, ЯКИЙ ПСАЛОМ ПОТРІБЕН ДЛЯ ДАНОЇ ДАТИ
# ----------------------------------------------------------------------------
def select_psalm_for_date(date_obj: datetime.date) -> int:
    """
    Визначаємо псалом (95, 100, 24 або 67) для конкретної дати
    за такими правилами:
      1) Якщо дата у FIXED_DATES як "solemnity" → Псалом 24
      2) Інакше, якщо дата у FIXED_DATES як "obligatory" → Псалом 67
      3) Інакше, якщо це неділя (weekday == 6) → Псалом 100
      4) Усі решта випадків → Псалом 95
    """
    key = (date_obj.month, date_obj.day)
    rank = FIXED_DATES.get(key, None)

    if rank == "solemnity":
        return 24
    if rank == "obligatory":
        return 67
    # Неділя
    if date_obj.weekday() == 6:
        return 100
    # За замовчуванням
    return 95


# ----------------------------------------------------------------------------
#  ФУНКЦІЯ: СТВОРИТИ HTML-ФРАГМЕНТ ІНВИТАТОРІЮ
# ----------------------------------------------------------------------------
def build_invitatory_html(date_obj: datetime.date, psalm_number: int) -> str:
    """
    date_obj: datetime.date
    psalm_number: int (95 | 100 | 24 | 67)
    Повертає: повний HTML-рядок <html>…</html> зі вставленим псалмом
    """

    # Обираємо відповідний список строф:
    if psalm_number == 100:
        psalm_list = PSALM_100
    elif psalm_number == 24:
        psalm_list = PSALM_24
    elif psalm_number == 67:
        psalm_list = PSALM_67
    else:
        psalm_list = PSALM_95

    date_str = date_obj.strftime("%Y-%m-%d")

    # Шапка документа:
    header = f"""<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>Інвитаторій – {date_str}</title>
  <link rel="stylesheet" href="/static/roman-uk/css/mi.css">
</head>
<body>
"""

    # Інвитаторій:
    invit_lines = INVIT_START

    # Антифон:
    antiphon_block = f"<p class=\"ant\">\n  {ANTIPHON}\n</p>\n"

    # Розгортаємо усі строфи псалма:
    psalm_block = ""
    for verse_html, needs_repeat in psalm_list:
        psalm_block += verse_html + "\n"
        if needs_repeat:
            psalm_block += "<span class=\"repeat-ant\">(Повторюється антифон)</span>\n"

    footer = "</body>\n</html>\n"

    return header + invit_lines + antiphon_block + psalm_block + footer


# ----------------------------------------------------------------------------
#  КАТАЛОГ ДЛЯ ВИХІДНИХ ФАЙЛІВ
# ----------------------------------------------------------------------------
OUTPUT_DIR = os.path.join("static", "roman-uk", "htm", "pdt", "mi")


def generate_for_month(year: int, month: int):
    """
    Генеруємо файли Інвитаторію для кожного дня у заданому місяці року
    та зберігаємо у OUTPUT_DIR як YYYY-MM-DD.htm
    """
    os.makedirs(OUTPUT_DIR, exist_ok=True)

    _, num_days = calendar.monthrange(year, month)
    for day in range(1, num_days + 1):
        d = datetime.date(year, month, day)

        # 1) Визначаємо псалом
        psalm_num = select_psalm_for_date(d)

        # 2) Генеруємо HTML
        html_content = build_invitatory_html(d, psalm_num)

        # 3) Пишемо файл
        filename = d.strftime("%Y_%m_%d") + ".htm"
        filepath = os.path.join(OUTPUT_DIR, filename)
        with open(filepath, "w", encoding="utf-8") as f:
            f.write(html_content)

        print(f"Згенеровано: {filepath}  (Псалом {psalm_num})")

    print(f"Інвитаторії для {year}-{month:02d} створено у {OUTPUT_DIR}")


# ----------------------------------------------------------------------------
#  ЗАПУСК: ГЕНЕРАЦІЯ ВСЬОГО РОКУ 2025
# ----------------------------------------------------------------------------
if __name__ == "__main__":
    # Щоб зробити весь рік 2025, запускаємо по кожному місяцю
    for m in range(1, 13):
        generate_for_month(2025, m)
